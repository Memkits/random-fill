let zhCities = [
  "七台河",
  "三亚",
  "三明",
  "三门峡",
  "上海",
  "上饶",
  "东莞",
  "东营",
  "中卫",
  "中山",
  "临汾",
  "临沂",
  "临沧",
  "丹东",
  "丽水",
  "丽江",
  "乌兰察布",
  "乌海",
  "乌鲁木齐",
  "乐山",
  "九江",
  "云浮",
  "亳州",
  "伊春",
  "伊犁",
  "佛山",
  "佳木斯",
  "保定",
  "保山",
  "信阳",
  "儋州",
  "克孜勒苏柯尔克孜",
  "克拉玛依",
  "六安",
  "六盘水",
  "兰州",
  "兴安盟",
  "内江",
  "凉山",
  "包头",
  "北京",
  "北海",
  "十堰",
  "南京",
  "南充",
  "南宁",
  "南平",
  "南昌",
  "南通",
  "南阳",
  "博尔塔拉",
  "厦门",
  "双鸭山",
  "台州",
  "合肥",
  "吉安",
  "吉林",
  "吐鲁番",
  "吐鲁番",
  "吕梁",
  "吴忠",
  "周口",
  "呼伦贝尔",
  "呼和浩特",
  "和田",
  "咸宁",
  "咸阳",
  "哈密",
  "哈尔滨",
  "唐山",
  "商丘",
  "商洛",
  "喀什",
  "嘉兴",
  "嘉峪关",
  "四平",
  "固原",
  "塔城",
  "大兴安岭",
  "大同",
  "大庆",
  "大理",
  "大连",
  "天水",
  "天津",
  "太原",
  "威海",
  "娄底",
  "孝感",
  "宁德",
  "宁波",
  "安庆",
  "安康",
  "安阳",
  "安顺",
  "定西",
  "宜宾",
  "宜昌",
  "宜春",
  "宝鸡",
  "宣城",
  "宿州",
  "宿迁",
  "山南",
  "山南",
  "岳阳",
  "崇左",
  "巢湖",
  "巴中",
  "巴彦淖尔",
  "巴音郭楞",
  "常州",
  "常德",
  "平凉",
  "平顶山",
  "广元",
  "广安",
  "广州",
  "庆阳",
  "廊坊",
  "延安",
  "延边",
  "开封",
  "张家口",
  "张家界",
  "张掖",
  "徐州",
  "德宏",
  "德州",
  "德阳",
  "忻州",
  "怀化",
  "怒江",
  "恩施",
  "惠州",
  "成都",
  "扬州",
  "承德",
  "抚州",
  "抚顺",
  "拉萨",
  "揭阳",
  "攀枝花",
  "文山",
  "新乡",
  "新余",
  "无锡",
  "日喀则",
  "日喀则",
  "日照",
  "昆明",
  "昌吉",
  "昌都",
  "昌都",
  "昭通",
  "晋中",
  "晋城",
  "普洱",
  "景德镇",
  "曲靖",
  "朔州",
  "朝阳",
  "本溪",
  "来宾",
  "杭州",
  "松原",
  "林芝",
  "林芝",
  "果洛",
  "枣庄",
  "柳州",
  "株洲",
  "桂林",
  "梅州",
  "梧州",
  "楚雄",
  "榆林",
  "武威",
  "武汉",
  "毕节",
  "毕节",
  "永州",
  "汉中",
  "汕头",
  "汕尾",
  "江门",
  "池州",
  "沈阳",
  "沧州",
  "河池",
  "河源",
  "泉州",
  "泰安",
  "泰州",
  "泸州",
  "洛阳",
  "济南",
  "济宁",
  "海东",
  "海东",
  "海北",
  "海南",
  "海口",
  "海西",
  "淄博",
  "淮北",
  "淮南",
  "淮安",
  "深圳",
  "清远",
  "温州",
  "渭南",
  "湖州",
  "湘潭",
  "湘西",
  "湛江",
  "滁州",
  "滨州",
  "漯河",
  "漳州",
  "潍坊",
  "潮州",
  "濮阳",
  "烟台",
  "焦作",
  "牡丹江",
  "玉林",
  "玉树",
  "玉溪",
  "珠海",
  "甘南",
  "甘孜",
  "白城",
  "白山",
  "白银",
  "百色",
  "益阳",
  "盐城",
  "盘锦",
  "眉山",
  "石嘴山",
  "石家庄",
  "福州",
  "秦皇岛",
  "红河",
  "绍兴",
  "绥化",
  "绵阳",
  "聊城",
  "肇庆",
  "自贡",
  "舟山",
  "芜湖",
  "苏州",
  "茂名",
  "荆州",
  "荆门",
  "莆田",
  "莱芜",
  "菏泽",
  "萍乡",
  "营口",
  "葫芦岛",
  "蚌埠",
  "衡水",
  "衡阳",
  "衢州",
  "襄樊",
  "西双版纳",
  "西宁",
  "西安",
  "许昌",
  "贵港",
  "贵阳",
  "贺州",
  "资阳",
  "赣州",
  "赤峰",
  "辽源",
  "辽阳",
  "达州",
  "运城",
  "连云港",
  "迪庆",
  "通化",
  "通辽",
  "遂宁",
  "遵义",
  "邢台",
  "那曲",
  "邯郸",
  "邵阳",
  "郑州",
  "郴州",
  "鄂尔多斯",
  "鄂州",
  "酒泉",
  "重庆",
  "金华",
  "金昌",
  "钦州",
  "铁岭",
  "铜仁",
  "铜仁",
  "铜川",
  "铜陵",
  "银川",
  "锡林郭勒",
  "锦州",
  "镇江",
  "长春",
  "长沙",
  "长治",
  "阜新",
  "阜阳",
  "防城港",
  "阳江",
  "阳泉",
  "阿克苏",
  "阿勒泰",
  "阿坝",
  "阿拉善盟",
  "阿里",
  "陇南",
  "随州",
  "雅安",
  "青岛",
  "鞍山",
  "韶关",
  "马鞍山",
  "驻马店",
  "鸡西",
  "鹤壁",
  "鹤岗",
  "鹰潭",
  "黄冈",
  "黄南",
  "黄山",
  "黄石",
  "黑河",
  "黔东南",
  "黔南",
  "黔西南",
  "齐齐哈尔",
  "龙岩",
];

let enCities = [
  "Aba",
  "Akesu",
  "Alashanmeng",
  "Aletai",
  "Ali",
  "Ankang",
  "Anqing",
  "Anshan",
  "Anshun",
  "Anyang",
  "Baicheng",
  "Baise",
  "Baishan",
  "Baiyin",
  "Baoding",
  "Baoji",
  "Baoshan",
  "Baotou",
  "Bayannur",
  "Bayinguoleng",
  "Bazhong",
  "Beihai",
  "Beijing",
  "Bengbu",
  "Benxi",
  "Bijie",
  "Bijie",
  "Binzhou",
  "Boertala",
  "Bozhou",
  "Cangzhou",
  "Chamdo",
  "Changchun",
  "Changde",
  "Changdou",
  "Changji",
  "Changsha",
  "Changzhi",
  "Changzhou",
  "Chaohu",
  "Chaoyang",
  "Chaozhou",
  "Chengde",
  "Chengdu",
  "Chenzhou",
  "Chifeng",
  "Chizhou",
  "Chongqing",
  "Chongzuo",
  "Chuxiong",
  "Chuzhou",
  "Dali",
  "Dalian",
  "Dandong",
  "Danzhou",
  "Daqing",
  "Datong",
  "Daxinganling",
  "Dazhou",
  "Dehong",
  "Deyang",
  "Dezhou",
  "Dingxi",
  "Diqing",
  "Dongguan",
  "Dongying",
  "Enshi",
  "Ezhou",
  "Fangchenggang",
  "Foshan",
  "Fushun",
  "Fuxin",
  "Fuyang",
  "Fuzhou",
  "Fuzhou",
  "Gannan",
  "Ganzhou",
  "Ganzi",
  "GuangAn",
  "Guangyuan",
  "Guangzhou",
  "Guigang",
  "Guilin",
  "Guiyang",
  "Guoluo",
  "Guyuan",
  "Haibei",
  "Haidong",
  "Haidong",
  "Haikou",
  "Hainan",
  "Haixi",
  "Hami",
  "Handan",
  "Hangzhou",
  "Hanzhong",
  "Harbin",
  "Hebi",
  "Hechi",
  "Hefei",
  "Hegang",
  "Heihe",
  "Hengshui",
  "Hengyang",
  "Hetian",
  "Heyuan",
  "Heze",
  "Hezhou",
  "Hohhot",
  "Honghe",
  "Huaibei",
  "Huaihua",
  "Huainan",
  "Huainan",
  "Huanggang",
  "Huangnan",
  "Huangshan",
  "Huangshi",
  "Huizhou",
  "Huludao",
  "Hulunbuir",
  "Huzhou",
  "JiAn",
  "Jiamusi",
  "Jiangmen",
  "Jiaozuo",
  "Jiaxing",
  "Jiayuguan",
  "Jieyang",
  "Jilin",
  "Jinan",
  "Jinchang",
  "Jincheng",
  "Jingdezhen",
  "Jingmen",
  "Jingzhou",
  "Jinhua",
  "Jining",
  "Jinzhong",
  "Jinzhou",
  "Jiujiang",
  "Jiuquan",
  "Jixi",
  "Kaifeng",
  "Karamay",
  "Kashen",
  "Kezilesukeerkezi",
  "Kunming",
  "Laibin",
  "Laiwu",
  "Langfang",
  "Lanzhou",
  "Leshan",
  "Lhasa",
  "Liangshan",
  "Lianyungang",
  "Liaocheng",
  "Liaoyang",
  "Liaoyuan",
  "Lijiang",
  "Lincang",
  "Linfen",
  "Linguolexi",
  "Linyi",
  "Linzhi",
  "Lishui",
  "Liupanshui",
  "Liuzhou",
  "Longnan",
  "Longyan",
  "Loudi",
  "LuAn",
  "Luohe",
  "Luoyang",
  "Luzhou",
  "Lüliang",
  "MaAnshan",
  "Maoming",
  "Meishan",
  "Meizhou",
  "Mianyang",
  "Mudanjiang",
  "Nanchang",
  "Nanchong",
  "Nanjing",
  "Nanning",
  "Nanping",
  "Nantong",
  "Nanyang",
  "Naqu",
  "Neijiang",
  "Ningbo",
  "Ningde",
  "Nujiang",
  "Nyingchi",
  "Ordos",
  "Panjin",
  "Panzhihua",
  "Pingdingshan",
  "Pingliang",
  "Pingxiang",
  "PuEr",
  "Putian",
  "Puyang",
  "Qiandongnan",
  "Qiannan",
  "Qianxinan",
  "Qingdao",
  "Qingyang",
  "Qingyuan",
  "Qinhuangdao",
  "Qinzhou",
  "Qiqihar",
  "Qitaihe",
  "Quanzhou",
  "Qujing",
  "Quzhou",
  "Rikaze",
  "Rizhao",
  "Sanmenxia",
  "Sanming",
  "Sanya",
  "Shanghai",
  "Shangluo",
  "Shangqiu",
  "Shangrao",
  "Shannan",
  "Shannan",
  "Shantou",
  "Shanwei",
  "Shaoguan",
  "Shaoxing",
  "Shaoyang",
  "Shenyang",
  "Shenzhen",
  "Shigatse",
  "Shijiazhuang",
  "Shiyan",
  "Shizuishan",
  "Shuangyashan",
  "Shuozhou",
  "Siping",
  "Songyuan",
  "Suihua",
  "Suining",
  "Suizhou",
  "Suqian",
  "Suzhou",
  "Suzhou",
  "Tacheng",
  "TaiAn",
  "Taiyuan",
  "Taizhou",
  "Taizhou",
  "Tangshan",
  "Tianjin",
  "Tianshui",
  "Tieling",
  "Tongchuan",
  "Tonghua",
  "Tongliao",
  "Tongling",
  "Tongren",
  "Tongren",
  "Tulufan",
  "Turpan",
  "Ulanqab",
  "Urumqi",
  "Weifang",
  "Weihai",
  "Weinan",
  "Wenshan",
  "Wenzhou",
  "Wuhai",
  "Wuhan",
  "Wuhu",
  "Wuwei",
  "Wuxi",
  "Wuzhong",
  "Wuzhou",
  "XiAn",
  "Xiamen",
  "Xiangfan",
  "Xiangtan",
  "Xiangxi",
  "Xianning",
  "Xianyang",
  "Xiaogan",
  "Xinganmeng",
  "Xingtai",
  "Xining",
  "Xinxiang",
  "Xinyang",
  "Xinyu",
  "Xinzhou",
  "Xishuangbanna",
  "Xuancheng",
  "Xuchang",
  "Xuzhou",
  "YaAn",
  "YanAn",
  "Yanbian",
  "Yancheng",
  "Yangjiang",
  "Yangquan",
  "Yangzhou",
  "Yantai",
  "Yibin",
  "Yichang",
  "Yichun",
  "Yichun",
  "Yili",
  "Yinchuan",
  "Yingkou",
  "Yingtan",
  "Yiyang",
  "Yongzhou",
  "Yueyang",
  "Yulin",
  "Yulin",
  "Yuncheng",
  "Yunfu",
  "Yushu",
  "Yuxi",
  "Zaozhuang",
  "Zhangjiajie",
  "Zhangjiakou",
  "Zhangye",
  "Zhangzhou",
  "Zhanjiang",
  "Zhaoqing",
  "Zhaotong",
  "Zhengzhou",
  "Zhenjiang",
  "Zhongshan",
  "Zhongwei",
  "Zhoukou",
  "Zhoushan",
  "Zhuhai",
  "Zhumadian",
  "Zhuzhou",
  "Zibo",
  "Zigong",
  "Ziyang",
  "Zunyi",
];

let chars = "QWERTYUIOPAJKLXVNM1234567890";

// TODO

let randomZh = () => {
  return zhCities[Math.floor(zhCities.length * Math.random())];
};

let randomEn = () => {
  return enCities[Math.floor(enCities.length * Math.random())];
};

let randomCode = () => {
  let len = 1 + Math.random() * 5;
  let buffer = "";
  for (let i = 0; i < len; i++) {
    buffer += chars[Math.floor(chars.length * Math.random())];
  }
  return buffer;
};

let randomPiece = () => {
  let x = Math.random() * 3;
  if (x > 2) {
    return randomZh();
  } else if (x > 1) {
    return randomEn();
  } else {
    return randomCode();
  }
};

chrome.commands.onCommand.addListener((command) => {
  // console.log("has command", command);
  if (command === "random-fill") {
    chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {
      chrome.tabs.sendMessage(
        tabs[0].id,
        { action: "random-fill", text: randomPiece() },
        function (response) {
          // console.log(response);
        }
      );
    });
  }
});

chrome.runtime.onMessage.addListener(function (request, sender, sendResponse) {
  if (request.action == "popup-fill") {
    sendResponse({ action: "pong" });

    let text = "TODO";
    switch (request.data) {
      case "zh":
        text = randomZh();
        break;
      case "en":
        text = randomEn();
        break;
      case "code":
        text = randomCode();
        break;
    }

    chrome.tabs.query({ active: true, currentWindow: true }, function (tabs) {
      chrome.tabs.sendMessage(
        tabs[0].id,
        { action: "random-fill", text: text },
        function (response) {
          // console.log(response);
        }
      );
    });
  }
});
